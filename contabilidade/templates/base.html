{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Lumina Contabilidade{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      html {
        scroll-behavior: smooth;
      }
      .glass-effect {
        background-color: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(4px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body class="min-h-screen font-sans antialiased text-slate-900">
    {% include 'partials/header.html' %} {% if messages %}
    <div
      id="toast-container"
      class="fixed top-20 right-4 z-[60] space-y-2 pointer-events-none"
    >
      {% for message in messages %}
      <div
        class="pointer-events-auto px-6 py-4 rounded-lg shadow-xl flex items-center gap-3 animate-bounce border text-white {% if 'error' in message.tags %} bg-red-500 border-red-400 {% else %} bg-green-500 border-green-400 {% endif %}"
      >
        {% if 'error' in message.tags %}
        <i data-lucide="alert-circle" class="w-6 h-6"></i>
        {% elif 'warning' in message.tags %}
        <i data-lucide="alert-triangle" class="w-6 h-6"></i>
        {% else %}
        <i data-lucide="check-circle" class="w-6 h-6"></i>
        {% endif %}

        <div class="flex flex-col">
          <span class="font-bold text-sm uppercase opacity-90">
            {% if 'error' in message.tags %} Erro {% else %}Sucesso{% endif %}
          </span>
          <span class="font-medium text-sm">{{ message }}</span>
        </div>
      </div>
      {% endfor %}
    </div>
    <script>
      setTimeout(() => {
        const container = document.getElementById("toast-container");
        if (container) {
          const messages = container.children;

          Array.from(messages).forEach((msg) => {
            msg.style.transition = "all 0.5s ease";
            msg.style.opacity = "0";
            msg.style.transform = "translateX(100%)";
          });

          setTimeout(() => {
            container.remove();
          }, 500);
        }
      }, 4000);
    </script>
    {% endif %}

    <main class="min-h-screen">{% block content %} {% endblock %}</main>

  </body>
  <script>
    lucide.createIcons();

    const header = document.getElementById("main-header");
    window.addEventListener("scroll", () => {
      if (header) {
        if (window.scrollY > 10) {
          header.classList.add("glass-effect", "shadow-lg");
          header.classList.remove("bg-slate-900");
        } else {
          header.classList.remove("glass-effect", "shadow-lg");
          header.classList.add("bg-slate-900");
        }
      }
    });

    const mobileBtn = document.getElementById("mobile-menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");

    if (mobileBtn && mobileMenu) {
      const menuIcon = mobileBtn.querySelector('[data-lucide="menu"]');
      let isMenuOpen = false;

      mobileBtn.addEventListener("click", () => {
        isMenuOpen = !isMenuOpen;
        if (isMenuOpen) {
          mobileMenu.classList.remove("hidden");
          if (menuIcon) menuIcon.setAttribute("data-lucide", "x");
        } else {
          mobileMenu.classList.add("hidden");
          if (menuIcon) menuIcon.setAttribute("data-lucide", "menu");
        }
        lucide.createIcons();
      });
    }
  </script>
</html>
